<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMMANDER BODY JUDGE // V2.0 FULL BODY</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
    <style>
        :root { --bg: #050505; --green: #00ff41; --gold: #ffd700; --red: #ff3333; --blue: #00bfff; }
        body { background: var(--bg); color: var(--green); font-family: 'Courier New', monospace; padding: 20px; max-width: 900px; margin: 0 auto; }
        .module { border: 1px solid #333; padding: 15px; margin-bottom: 20px; background: rgba(0,20,0,0.4); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        input, select { width: 100%; background: #0a0a0a; color: var(--green); border: 1px solid #333; padding: 12px; font-size: 1em; }
        button { width: 100%; padding: 15px; background: var(--green); color: #000; font-weight: bold; border: none; cursor: pointer; margin-top: 20px; font-size: 1.1em; }
        
        .med-card { background: #111; border-left: 4px solid #555; margin-bottom: 10px; padding: 10px; }
        .p1 { border-color: var(--gold); }
        .p2 { border-color: var(--blue); }
        .ban { border-color: var(--red); color: #888; text-decoration: line-through; }
        .ext { border-color: #fff; } /* å¤–ç”¨è¯ */
        
        .badge { display: inline-block; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-right: 5px; font-weight: bold; }
        .badge-p1 { background: var(--gold); color: #000; }
        .badge-p2 { background: var(--blue); color: #000; }
        .badge-ext { background: #fff; color: #000; }
        .badge-warn { background: var(--red); color: #fff; }
    </style>
</head>
<body>

<h1>COMMANDER BODY JUDGE <span style="font-size:0.5em; color:#666">V2.0</span></h1>

<div class="module">
    <h3>INPUT DATA // ç—‡çŠ¶é”å®š</h3>
    <div class="grid-2">
        <div><label>â¤ï¸ RHR (é™æ¯å¿ƒç‡)</label><input type="number" id="rhr" placeholder="e.g. 63"></div>
        <div><label>ğŸ’© å¤§ä¾¿/å± (Stool/Gas)</label>
            <select id="poop">
                <option value="normal">æ­£å¸¸</option>
                <option value="fart_stink">ğŸ’¨ æ”¾å±å¤š/è‡­é¸¡è›‹å‘³ (é£Ÿç§¯)</option>
                <option value="sticky">ğŸ’© ç²˜é©¬æ¡¶ (æ¹¿çƒ­)</option>
                <option value="loose">ğŸ’© ä¸æˆå½¢ (è„¾å¯’)</option>
                <option value="dry">ğŸ’© å¹²ç»“ (é˜´è™š)</option>
            </select>
        </div>
    </div>
    <div class="grid-2" style="margin-top:15px">
        <div><label>ğŸ“ æ ¸å¿ƒæˆ˜åŒº (Zone)</label>
            <select id="part" onchange="updateSpecifics()">
                <option value="head">ğŸ”´ å¤´éƒ¨/äº”å®˜ (Head/Face)</option>
                <option value="neck_chest">ğŸŸ¡ é¢ˆè‚©/èƒ¸è…¹ (Neck/Torso)</option>
                <option value="limbs">ğŸ”µ å››è‚¢/å…³èŠ‚ (Limbs/Joints)</option>
                <option value="skin">âšª çš®è‚¤/ç—¤ç–® (Skin)</option>
                <option value="lower">ğŸŸ£ ä¸‹ç„¦/å‰åˆ—è…º (Lower)</option>
            </select>
        </div>
        <div><label>ğŸ¯ ç²¾å‡†æ‰“å‡» (Target)</label>
            <select id="specific"><option value="none">-- è¯·é€‰æ‹© --</option></select>
        </div>
    </div>
    <button onclick="diagnose()">âš¡ EXECUTE PROTOCOL âš¡</button>
</div>

<div id="output" class="module" style="display:none">
    <h2 id="diag-title" style="color:#fff"></h2>
    <div id="med-list"></div>
    <div class="med-card" style="border-color: #fff; margin-top:20px;">
        <h3 style="margin:0 0 5px 0; color:#fff">ğŸŸ¢ SOP ACTION</h3>
        <p id="action-text" style="margin:0; color:#ccc"></p>
    </div>
</div>

<script>
// ==========================================
// 1. æ‰©å®¹å†›ç«åº“ (Expanded Arsenal)
// ==========================================
const DRUGS = {
    // TCM Internal
    'chuanxiong': { name: "å·èŠèŒ¶è°ƒä¸¸", usage: "é¥­åæœç”¨ã€‚ä¸“æ²»é£é‚ªå¤´ç—›ã€‚", type: 'tcm' },
    'gegen': { name: "è‘›æ ¹æ±¤é¢—ç²’", usage: "æ¸©æ°´å†²æœã€‚ä¸“æ²»é¢ˆæ¤åƒµç—›ã€‚", type: 'tcm' },
    'xiaochaihu': { name: "å°æŸ´èƒ¡é¢—ç²’", usage: "ä¸¤é¤ä¹‹é—´ã€‚æ²»å¿½å†·å¿½çƒ­/å£è‹¦ã€‚", type: 'tcm' },
    'yupingfeng': { name: "ç‰å±é£æ•£", usage: "é¥­å‰æœç”¨ã€‚å¢å¼ºå…ç–«/é˜²å†·é£ã€‚", type: 'tcm' },
    'lanqin': { name: "è“èŠ©å£æœæ¶²", usage: "é¥­åæœç”¨ã€‚æ¸…çƒ­è§£æ¯’ã€‚", type: 'tcm' },
    'qingwei': { name: "æ¸…èƒƒé»„è¿ä¸¸", usage: "é¥­åæœç”¨ã€‚æ²»ä¸Šç‰™ç«ç—›ã€‚", type: 'tcm' },
    'muxiang': { name: "æœ¨é¦™é¡ºæ°”ä¸¸", usage: "é¥­åæœç”¨ã€‚æ²»æ°”æ»è…¹ç—›ã€‚", type: 'tcm' },
    'baohe': { name: "ä¿å’Œä¸¸", usage: "é¥­åæœç”¨ã€‚æ²»è‡­å±/é£Ÿç§¯ã€‚", type: 'tcm' },
    'duhuo': { name: "ç‹¬æ´»å¯„ç”Ÿä¸¸", usage: "é¥­åæœç”¨ã€‚æ²»é£æ¹¿ç—¹ç—›/å…³èŠ‚é‡ã€‚", type: 'tcm' },
    'shaoyao': { name: "èŠè¯ç”˜è‰æ±¤", usage: "å‘ä½œæ—¶æœç”¨ã€‚æ²»æŠ½ç­‹ã€‚", type: 'tcm' },
    'ermiao': { name: "äºŒå¦™ä¸¸", usage: "é¥­åæœç”¨ã€‚æ²»ä¸‹ç„¦æ¹¿çƒ­ã€‚", type: 'tcm' },
    
    // Western / External
    'ibuprofen': { name: "å¸ƒæ´›èŠ¬ (Ibuprofen)", usage: "é¥­å/ç—›æ—¶åƒã€‚", type: 'west' },
    'vitc': { name: "ç»´ç”Ÿç´ C (1000mg)", usage: "æ¯4å°æ—¶ä¸€æ¬¡ (æ„Ÿå†’å‰å…†)ã€‚", type: 'west' },
    'patch': { name: "æ°Ÿæ¯”æ´›èŠ¬å‡èƒ¶è´´è†", usage: "è´´æ‚£å¤„ (12å°æ—¶ä¸€æ¢)ã€‚", type: 'ext' },
    'erythromycin': { name: "çº¢éœ‰ç´ çœ¼è†", usage: "æ¶‚çœ¼ç‘ (ç¡å‰)ã€‚", type: 'ext' },
    'jinhuang': { name: "å¦‚æ„é‡‘é»„æ•£", usage: "èœ‚èœœè°ƒæ•·æ‚£å¤„ (å±è‚¡ç––å­)ã€‚", type: 'ext' },
    'adapalene': { name: "ç»´Aé…¸ä¹³è†", usage: "ç¡å‰æ¶‚ (é¿å…‰)ã€‚", type: 'ext' },
    'magnesium': { name: "è¡¥é• (Magnesium)", usage: "ç«‹å³æœç”¨ã€‚", type: 'west' }
};

// ==========================================
// 2. ç—‡çŠ¶æ˜ å°„ (Specifics Map)
// ==========================================
const SPECIFICS_MAP = {
    'head': [
        {val:'migraine', txt:'åå¤´ç—› (ä¸¤ä¾§/åè„‘)'},
        {val:'eye_pain', txt:'çœ¼ç›ç—›/éº¦ç²’è‚¿'},
        {val:'nose_pain', txt:'é¼»å­å¸å†·æ°”ç—› (æ„Ÿå†’å…†)'},
        {val:'tooth_up', txt:'ä¸Šç‰™ç—› (èƒƒç«)'},
        {val:'tooth_down', txt:'ä¸‹ç‰™ç—› (å¤§è‚ ç«)'},
        {val:'throat', txt:'å—“å­ç—›'}
    ],
    'neck_chest': [
        {val:'neck', txt:'é¢ˆæ¤ç—› (åä»°ç—›)'},
        {val:'chest_nerve', txt:'å«èƒ¸èƒ¸ç—› (ç¥ç»æ€§)'},
        {val:'belly_pain', txt:'è…¹éƒ¨æŒ‰å‹ç—› (æ‹’æŒ‰)'},
        {val:'belly_ok', txt:'è…¹éƒ¨å–œæŒ‰ (è™šå¯’)'}
    ],
    'limbs': [
        {val:'joint_all', txt:'å››è‚¢å…³èŠ‚æ¸¸èµ°ç—›'},
        {val:'knee_hip', txt:'è†ç›–/å¤§èƒ¯ç—› (ç‰©ç†ä¼¤)'},
        {val:'cramp', txt:'å·¦è‡‚/å¿ƒè„æŠ½ç­‹ (é«˜å±)'}
    ],
    'skin': [
        {val:'acne_face', txt:'é¢éƒ¨ç—¤ç–®'},
        {val:'acne_butt', txt:'å±è‚¡ç––å­ (éª‘è¡Œ)'}
    ],
    'lower': [
        {val:'prostate', txt:'å‰åˆ—è…º/å°¿çŸ­èµ¤'},
        {val:'fart', txt:'æ”¾å±è‡­/å¤š'}
    ]
};

function updateSpecifics() {
    const part = document.getElementById('part').value;
    const s = document.getElementById('specific');
    s.innerHTML = '<option value="none">-- è¯·é€‰æ‹© --</option>';
    if(SPECIFICS_MAP[part]) SPECIFICS_MAP[part].forEach(o => s.innerHTML += `<option value="${o.val}">${o.txt}</option>`);
}

// ==========================================
// 3. æ ¸å¿ƒè£å†³ (Diagnosis Logic)
// ==========================================
function diagnose() {
    const part = document.getElementById('part').value;
    const spec = document.getElementById('specific').value;
    const poop = document.getElementById('poop').value;
    const rhr = parseInt(document.getElementById('rhr').value) || 0;

    let title = "";
    let p1 = null, p2 = null, ext = null, action = "";

    // --- è·¯ç”±ç³»ç»Ÿ ---

    // A. å¤´éƒ¨/äº”å®˜
    if (part === 'head') {
        if (spec === 'migraine') {
            title = "ã€åå¤´ç—›/é£ç«ä¸Šæ‰°ã€‘"; p1 = 'chuanxiong'; p2 = 'ibuprofen';
            action = "é¿å…‰ä¼‘æ¯ã€‚è‹¥ä¼´éšå¿½å†·å¿½çƒ­åŠ å°æŸ´èƒ¡ã€‚";
        } else if (spec === 'eye_pain') {
            title = "ã€éº¦ç²’è‚¿/è‚ç«ã€‘"; ext = 'erythromycin'; p1 = 'lanqin';
            action = "çƒ­æ•·çœ¼éƒ¨(ä¿ƒåŒ–è„“)ã€‚";
        } else if (spec === 'nose_pain') {
            title = "ã€é£å¯’ä¾µè¢­/æ„Ÿå†’å‰å…†ã€‘"; p1 = 'xiaochaihu'; p2 = 'vitc';
            action = "å–è‘±ç™½æ°´ï¼Œæˆ´å£ç½©ï¼Œä¿æš–é¼»éƒ¨ã€‚";
        } else if (spec === 'tooth_up') {
            title = "ã€èƒƒç«ç‰™ç—›ã€‘"; p1 = 'qingwei'; p2 = 'ibuprofen';
            action = "å¿Œé…’è¾£ã€‚";
        } else if (spec === 'tooth_down') {
            title = "ã€å¤§è‚ ç«ç‰™ç—›ã€‘"; p1 = 'niuhuang'; // éœ€äººå·¥ç‰›é»„
            action = "å¤šå–æ°´ï¼Œé€šä¾¿ã€‚";
        } else if (spec === 'throat') {
            title = "ã€å’½å–‰è‚¿ç—›ã€‘"; p1 = 'lanqin';
            action = "æ·¡ç›æ°´æ¼±å£ã€‚";
        }
    }

    // B. é¢ˆè‚©/èƒ¸è…¹
    else if (part === 'neck_chest') {
        if (spec === 'neck') {
            title = "ã€é¢ˆæ¤ç—…/å¤ªé˜³ç»ä¸åˆ©ã€‘"; p1 = 'gegen'; ext = 'patch';
            action = "çƒ­æ•·åé¢ˆï¼Œé¿å…ä½å¤´ã€‚";
        } else if (spec === 'chest_nerve') {
            title = "ã€è‚‹é—´ç¥ç»ç—›/æ°”æ»ã€‘"; p1 = 'muxiang';
            action = "æ‰©èƒ¸è¿åŠ¨ï¼Œæ·±å‘¼å¸ã€‚";
        } else if (spec === 'belly_pain') { // æ‹’æŒ‰
            title = "ã€æ°”æ»è¡€ç˜€ã€‘"; p1 = 'muxiang';
            action = "æ‰è…¹ï¼Œå°‘åƒèƒ€æ°”é£Ÿç‰©ã€‚";
        }
    }

    // C. å››è‚¢/å…³èŠ‚
    else if (part === 'limbs') {
        if (spec === 'joint_all') {
            title = "ã€é£æ¹¿ç—¹ç—›/å¤´ç—›å‰å…†ã€‘"; p1 = 'duhuo'; p2 = 'ibuprofen';
            action = "æ³¨æ„é˜²é£ï¼Œå¯èƒ½æ˜¯åå¤´ç—›å‰å…†ï¼Œæå‰é˜»æ–­ã€‚";
        } else if (spec === 'knee_hip') {
            title = "ã€è¿åŠ¨åŠ³æŸã€‘"; ext = 'patch';
            action = "æš‚åœéª‘è¡Œï¼Œå†°æ•·(æ€¥æ€§)æˆ–çƒ­æ•·(æ…¢æ€§)ã€‚";
        } else if (spec === 'cramp') {
            title = "ğŸš¨ã€é«˜å±ï¼šç”µè§£è´¨ç´Šä¹±ã€‘"; p1 = 'shaoyao'; p2 = 'magnesium';
            action = "ç«‹å³åœæ­¢è¿åŠ¨ï¼è¡¥é’¾è¡¥é•ï¼è‹¥å¿ƒè„ä¸é€‚ç«‹å³å°±åŒ»ã€‚";
        }
    }

    // D. çš®è‚¤
    else if (part === 'skin') {
        if (spec === 'acne_butt') {
            title = "ã€åæ¿ç–®/æ¹¿çƒ­ã€‘"; ext = 'jinhuang'; p1 = 'ermiao';
            action = "å‡å°‘éª‘è¡Œæ—¶é—´ï¼Œä¿æŒå¹²ç‡¥ã€‚";
        } else if (spec === 'acne_face') {
            title = "ã€è‚ºèƒƒçƒ­ç››ã€‘"; ext = 'adapalene';
            action = "æ•å·¾æ¯æ—¥æ¢ï¼Œå¿Œç³–æ²¹ã€‚";
        }
    }

    // E. æ”¾å±/ä¸‹ç„¦
    else if (part === 'lower' || poop === 'fart_stink') {
        if (poop === 'fart_stink') {
            title = "ã€é£Ÿç§¯/æ¶ˆåŒ–ä¸è‰¯ã€‘"; p1 = 'baohe';
            action = "å°‘åƒè‚‰ï¼Œæ–­é£Ÿä¸€é¡¿æ™šé¤ã€‚";
        } else if (spec === 'prostate') {
            title = "ã€ä¸‹ç„¦æ¹¿çƒ­ã€‘"; p1 = 'ermiao';
            action = "æ¸©æ°´åæµ´ã€‚";
        }
    }

    render(title, p1, p2, ext, action);
}

function render(title, p1Key, p2Key, extKey, actionText) {
    document.getElementById('output').style.display = 'block';
    document.getElementById('diag-title').innerText = title;
    document.getElementById('action-text').innerText = actionText;
    
    const list = document.getElementById('med-list');
    list.innerHTML = '';

    function createCard(key, role) {
        if(!key) return;
        const d = DRUGS[key];
        if(!d) return; // å®¹é”™
        let badgeClass = role === 'p1' ? 'badge-p1' : (role === 'p2' ? 'badge-p2' : 'badge-ext');
        let roleName = role === 'p1' ? 'ğŸ‘‘ ä¸»å°†' : (role === 'p2' ? 'ğŸ›¡ï¸ å‰¯å°†' : 'ğŸ©¹ å¤–ç”¨/æ€¥æ•‘');
        
        return `
            <div class="med-card ${role === 'ext' ? 'ext' : (role === 'p1' ? 'p1' : 'p2')}">
                <div style="display:flex; justify-content:space-between; align-items:center">
                    <span style="font-size:1.1em; font-weight:bold; color:#fff">${d.name}</span>
                    <span class="badge ${badgeClass}">${roleName}</span>
                </div>
                <div style="font-size:0.9em; color:#aaa; margin-top:5px; font-style:italic">SOP: ${d.usage}</div>
            </div>
        `;
    }

    if (p1Key) list.innerHTML += createCard(p1Key, 'p1');
    if (p2Key) list.innerHTML += createCard(p2Key, 'p2');
    if (extKey) list.innerHTML += createCard(extKey, 'ext');
}
</script>

</body>
</html>
